---
layout: post
title: "HYGENE: A Diffusion-based Hypergraph Generation Method"
date: 2024-08-23
description: HYGENE
tags: machine-learning generative-models graph-theory hypergraphs
categories: papers
---

# HYGENE: A Diffusion-based Hypergraph Generation Method

This blog post will summarize our recent paper, [**HYGENE: A Diffusion-based Hypergraph Generation Method**](http://arxiv.org/abs/2408.16457). To the best of our knowledge, this work introduces the first deep-learning based method for hypergraph generation. Code is available [here](https://github.com/DorianGailhard/SODA_Hypergraph-generation).

## Preliminaries

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/random_graph.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/random_hypergraph.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    A random graph and a random hypergraph.
</div>


[Traditional graphs](https://en.wikipedia.org/wiki/Graph) consist of nodes connected by edges, with each edge linking precisely two nodes. [Hypergraphs](https://en.wikipedia.org/wiki/Hypergraph), however, offer a more versatile framework. In a hypergraph, edges — referred to as hyperedges — can connect an arbitrary number of nodes simultaneously. This generalization allows hypergraphs to capture higher-order and more nuanced relationships compared to standard graphs. This also makes them much more expressive, being for instance able to represent:

- 3D meshes can be represented with triangles as 3-edges
- Electronic circuits can be modeled with routers replaced by hyperedges connecting all associated components
- Molecules can be depicted more accurately, with functional groups like carboxylic acids joined into hyperedges to highlight their higher-order relationship

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/mesh.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/molecule.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/electronic_circuit.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Examples of hypergraph applications
</div>

Our work aims to develop a deep-learning based method capable of generating new samples from a given distribution of hypergraphs. For instance, given examples of 3D meshes representing variants of an object, we want to train a model that can generate new instances. As an initial step, we focus solely on the underlying topology of hypergraphs, disregarding features of nodes and hyperedges.

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_train_er.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_train_ego.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_train_sbm.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_train_tree.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Examples of datasets we tested our method against
</div>

In other words, given a dataset of unfeatured hypergraphs (without 3D positions, component types, or other characteristics) that share similar topological properties, our goal is to train a model capable of generating new hypergraphs with matching properties.

## Main Inspiration

Our work builds upon the foundation laid by the paper [Efficient and Scalable Graph Generation through Iterative Local Expansion](https://arxiv.org/abs/2312.11529), which introduces an innovative method for graph generation. This approach draws inspiration from the rich tradition of graph coarsening algorithms.

When graphs become excessively large, certain algorithms may become computationally infeasible. To address this, it is possible to create smaller, representative versions of the original graph (called coarsened versions) that retain key characteristics and properties. The authors of the aforementioned paper employed a [spectrum-preserving graph coarsening](https://arxiv.org/abs/1808.10650) technique. This method merges pairs of adjacent nodes in a way that preserves a [subspace of the eigenvalues and eigenvectors of the original graph](https://en.wikipedia.org/wiki/Spectral_graph_theory), maintaining crucial structural information.

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/coarsening.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    During coarsening, pairs of adjacent nodes are iteratively merged in order to create a reduced version of the graphs while preserving its spectral properties.
</div>

The coarsening algorithm is applied iteratively to create a coarsening sequence. The first element in this sequence is the original graph, while the last is a fully reduced version comprising a single node. The challenge then becomes training a model to invert this coarsening process.

Starting from a step in the sequence, the model must identify which nodes result from merging at the previous step. These nodes are then duplicated and connected, with each child retaining the connections of its parent node (expansion). A second model then determines which edges should be retained in the final graph (refinement).

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/graph_generation.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Starting from a single node, the model successively choose which nodes to duplicate at each step before a second model filter out the resulting edges.
</div>

The generation process simply involves applying this expansion and refinement procedure iteratively until obtaining a graph of the desired size. This approach scales more efficiently compared to existing techniques, as it leverages the graph's sparsity. When two parts of the graph become disconnected during an early generation step, there's no need to check for connections later, significantly reducing computational overhead.

## Our Work

We have successfully generalized this generation method to hypergraphs and tested it on several datasets. Given the challenges of working directly with hypergraphs due to variable hyperedge sizes and complex node relationships, we project the problem back into graph spaces using two equivalent representations.

### Coarsening Sequence / Downsampling

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/clique_expansion.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/clique_coarsening.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Coarsening: <b>(a)</b> Compute the weighted clique expansion by collapsing each hyperedge into an appropriately weighted clique. <b>(b)</b> Coarsen the clique expansion while preserving the spectral properties of the hypergraph (dark blue nodes).
</div>

To apply coarsening algorithms to hypergraphs, we represent them as their clique expansion. In this representation, each hyperedge $$e$$ is transformed into a clique weighted by $$1/ \vert e \vert$$ , where $$ \vert e \vert$$ is the size of the hyperedge. When an edge appears in multiple cliques, its weight becomes the sum of the weights from each clique.

This clique expansion is particularly useful for coarsening, as it maintains the same number of nodes as the original hypergraph and shares its spectral properties. Consequently, node mergings that preserve spectral properties in the clique expansion also preserve them in the hypergraph. To construct a coarsening sequence for a given hypergraph, we create an equivalent sequence for its clique expansion and merge the same pairs of nodes.

However, it's important to note that while deriving the clique expansion from a hypergraph is straightforward, the reverse process is NP-hard, which makes it infeasible to work with the clique expansion during generation.

<div class="row mt-3 justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/bipartite_coarsening.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    <b>(c)</b> Update the bipartite view: corresponding left side nodes (in dark blue) are merged, then right side nodes representing the same hyperedge (circled in black) are merged.
</div>

To address this limitation, we maintain another parallel representation of the hypergraph: the star expansion. This representation depicts the hypergraph as a bipartite graph, with one set of nodes corresponding to the hypergraph's nodes and the other representing hyperedges. Each node is connected to the hyperedges containing it.

When nodes are merged in the clique expansion, the same nodes are merged in the star expansion. If two nodes representing hyperedges have identical connections (i.e., represent the same hyperedge), they are also merged after the node mergings in the clique expansion. Beware that in this scheme, a single pair of node mergings can result in the merging of up to three hyperedges.

### Coarsening Inversion / Upsampling

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/hypergraph_generation.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Our model starts from a single pair of linked nodes (in the bipartite representation) and iteratively expands the left-side nodes (in dark blue) and right-side nodes (in red), where each duplicate keeps the connections of its parent node. Then, our method refines the resulting bipartite graph filtering edges to recover an appropriate local structure.
</div>

Beginning from a coarsening step, we train a model to identify which nodes and hyperedges result from merging at the previous coarsening step. These nodes are then expanded (nodes are duplicated twice, while hyperedges can be duplicated two or three times), with each child retaining its parent's connections. A second model is then trained to selectively filter out regular edges, reconstructing an accurate topology. Generation starts with a single pair of connected node (the minimal bipartite graph) and iteratively applies the above scheme until obtaining a hypergraph of the desired size. Once it is attained, we can retrieve the generated hypergraph by replacing each node representing a hyperedge with a hyperedge connecting all its neighbors.


## Pipeline

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/pipeline.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Combining everything gives the above pipeline: <b>(a)</b> a coarsening algorithm is applied to the clique expansion and generate a coarsening sequence by merging pairs of adjacent nodes <b>(b)</b> a bipartite representation is maintained in parallel, where nodes representing the same hyperedge are merged <b>(c)</b> a model is trained to invert the coarsening by <i>1.</i> identifying which nodes are the result of a merging at the previous step <i>2.</i> filtering out the edges added during the expansion.
</div>

## Results and Limitations

**Results**

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_generated_er.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_generated_ego.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_generated_sbm.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/hygene/sample_generated_tree.png" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Examples of generated samples corresponding to the datasets shown at the beginning.
</div>

As illustrated above, our method successfully imitates a variety of properties. For a comprehensive analysis of numerical results across various metrics, please refer to our [paper](http://arxiv.org/abs/2408.16457).

**Limitations**

Our method currently appears to disregard the specified number of nodes during generation, instead sampling from the node count distribution of the training data. Additionally, it encounters difficulties when dealing with datasets containing large hypergraphs.

## Conclusion

This work represents a significant first step towards deep-learning based hypergraph generation. Our future research will focus on improving the model's accuracy during generation, particularly concerning node count adherence, and expanding support for feature generation.

When using our work, please cite our paper:

```bibtex
@misc{gailhard2024hygenediffusionbasedhypergraphgeneration,
      title={HYGENE: A Diffusion-based Hypergraph Generation Method}, 
      author={Dorian Gailhard and Enzo Tartaglione and Lirida Naviner De Barros and Jhony H. Giraldo},
      year={2024},
      eprint={2408.16457},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2408.16457}, 
}
```


**Acknowledgments**
We acknowledge the [ANR – FRANCE](https://anr.fr/) (French National Research Agency) for its financial support of the [System On Chip Design leveraging Artificial Intelligence (SODA)](https://anr.fr/Project-ANR-23-IAS3-0004) project under grant ANR-23-IAS3-0004. This project has also been partially funded by the [Hi!PARIS Center on Data Analytics and Artificial Intelligence](https://www.hi-paris.fr/).
